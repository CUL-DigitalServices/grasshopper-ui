<html>
    <head>
        <title>Timetable Global Administration</title>

        <meta name="viewport" content="width=device-width" initial-scale="1.0">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

        <!-- .cam.ac.uk domain Typekit inclusion -->
        <script type="text/javascript" src="//use.typekit.com/hyb5bko.js"></script>
        <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

        <link rel="stylesheet" href="/shared/vendor/css/font-awesome.css">
        <link rel="stylesheet" href="/shared/vendor/css/bootstrap.css">
        <link rel="stylesheet" href="/shared/vendor/css/chosen.css">
        <link rel="stylesheet" href="/shared/vendor/css/fullcalendar.css">
        <link rel="stylesheet" href="/shared/gh/css/gh.base.css">
        <link rel="stylesheet" href="/shared/gh/css/gh.components.css">
        <link rel="stylesheet" href="/shared/gh/css/gh.skin.css">
        <link rel="stylesheet" href="/apps/admin/ui/css/admin.css">
        <link rel='stylesheet' href="/shared/gh/css/gh.print.css" media="print">
    </head>
    <body class="gh-global-admin gh-preload">
        <div id="gh-page-container">
            <div id="gh-left-container">
                <div id="gh-meta-container">
                    <a href="http://cam.ac.uk" id="gh-header-logo" target="_blank" title="Visit the Cambridge University website">
                        <img src="/shared/gh/img/unilogo.png" alt="Cambridge University">
                    </a>
                    <div id="gh-content-description">
                        <p style="display: none;">Select your course and part to view available modules</p>
                    </div>
                </div>
                <div id="gh-navigation-container"><!-- --></div>
            </div>
            <div id="gh-right-container">
                <div id="gh-header-container">
                    <div id="gh-header"></div>
                    <div id="gh-subheader"></div>
                </div>
                <main id="gh-main">
                    <div id="gh-configuration-container" style="display: none;"><!-- --></div>
                    <div id="gh-tenants-container" style="display: none;"><!-- --></div>
                    <div id="gh-administrators-container" style="display: none;"><!-- --></div>
                </main>
            </div>
            <div class="clearfix"></div>
        </div>

        <script id="gh-configuration-template" type="text/template">
            <div class="gh-administration-container">
                <h1>Configuration</h1>
                <% _.each(tenants, function(tenant) { %>
                    <% _.each(tenant.apps, function(app) { %>
                        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                            <div class="panel panel-default">
                                <div class="panel-heading" role="tab" id="headingOne">
                                    <h4 class="panel-title">
                                        <% var randomId = gh.utils.generateRandomString(true); %>
                                        <a data-toggle="collapse" data-parent="#accordion" href="#<%= randomId %>" aria-expanded="false" aria-controls="<%= randomId %>">
                                            <%- tenant.displayName %> - <%- app.displayName %> - <%- app.host %>
                                        </a>
                                    </h4>
                                </div>
                                <div id="<%= randomId %>" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                                    <div class="panel-body">
                                        <form role="form" class="gh-configuration-form" data-appid="<%= app.id %>">
                                            <% _.each(app.config, function(value, option) { %>
                                                <% if (option === 'AppId' || option === 'terms' || option === 'events') { return; }%>
                                                <% if (typeof value === 'boolean') { %>
                                                    <div class="checkbox">
                                                        <label>
                                                            <input type="checkbox" name="<%= option %>" value="<%= value %>" <% if (value === true) { %> checked<% } %>> <%= option %>
                                                        </label>
                                                    </div>
                                                <% } else { %>
                                                    <div class="form-group">
                                                        <label for="<%= option %>"><%= option %></label>
                                                        <input type="text" class="form-control" id="<%= option %>" value="<%= value %>" name="<%= option %>">
                                                    </div>
                                                <% } %>
                                            <% }) %>
                                            <button type="submit" class="btn btn-success">Update configuration</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    <% }) %>
                <% }) %>
            </div>
        </script>

        <script id="gh-tenants-template" type="text/template">
            <div class="gh-administration-container">
                <h1>Tenants and Apps</h1>

                <h2>Create a new tenant</h2>
                <form id="gh-tenants-create-tenant-form">
                    <div class="form-group">
                        <label for="gh-tenant-name" class="control-label">Tenant display name</label>
                        <input type="text" id="gh-tenant-name" class="form-control" placeholder="New tenant name"/>
                    </div>
                    <button type="submit" class="btn btn-default">Create tenant</button>
                </form>

                <h2>Tenants in the system</h2>
                <% _.each(tenants, function(tenant) { %>
                    <div class="panel-default gh-striped-container">
                        <h3 class="panel-heading"><%- tenant.displayName %></h3>
                        <div class="panel-body">
                            <div class="panel-subheading row">
                                <div class="gh-striped-heading col-sm-3">App name</div>
                                <div class="gh-striped-heading col-sm-3">App host</div>
                                <div class="gh-striped-heading col-sm-2">App enabled</div>
                                <div class="gh-striped-heading col-sm-4">Actions</div>
                            </div>
                            <% _.each(tenant.apps, function(app) { %>
                                <div class="gh-striped-row row">
                                    <form class="gh-tenants-app-update-form" data-appid="<%- app.id %>">
                                        <div class="col-sm-3">
                                            <input class="gh-app-displayname" type="text" placeholder="App name" value="<%- app.displayName %>"/>
                                        </div>
                                        <div class="col-sm-3">
                                            <input class="gh-app-host" type="text" placeholder="App host" value="<%- app.host %>"/>
                                        </div>
                                        <div class="col-sm-2">
                                            <input class="gh-app-enabled" type="checkbox"<% if (app.enabled) { %> checked<% } %>/>
                                        </div>
                                        <div class="col-sm-2">
                                            <button type="submit" class="btn btn-primary pull-left">Update app</button>
                                        </div>
                                        <div class="col-sm-2">
                                            <a href="//<%- app.host %>" target="_blank" class="btn btn-info pull-left"><i class="fa fa-external-link"></i> Open app</a>
                                        </div>
                                    </form>
                                </div>
                            <% }); %>
                            <div class="gh-striped-row row">
                                <form class="gh-tenants-app-create-form" data-tenantid="<%- tenant.id %>">
                                    <div class="col-sm-3">
                                        <input class="gh-app-displayname" type="text" placeholder="New app name"/>
                                    </div>
                                    <div class="col-sm-3">
                                        <input class="gh-app-host" type="text" placeholder="New app host"/>
                                    </div>
                                    <div class="col-sm-2">
                                        <input class="gh-app-enabled" type="checkbox" checked disabled/>
                                    </div>
                                    <div class="col-sm-4">
                                        <button type="submit" class="btn btn-success pull-left">Create app</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                <% }); %>
            </div>
        </script>

        <script id="gh-administrators-template" type="text/template">
            <div class="gh-administration-container">
                <h1>Users</h1>
                <div class="panel-default gh-striped-container">
                    <h3 class="panel-heading">Administrators in the system</h3>
                    <div class="panel-body">
                        <div class="panel-subheading row">
                            <div class="gh-striped-heading col-sm-3">Admin name</div>
                            <div class="gh-striped-heading col-sm-2">Admin username</div>
                            <div class="gh-striped-heading col-sm-3">Admin password</div>
                            <div class="gh-striped-heading col-sm-4">Actions</div>
                        </div>
                        <% _.each(administrators, function(admin) { %>
                            <div class="gh-striped-row row">
                                <form class="gh-administrators-update-form" data-userid="<%- admin.id %>">
                                    <div class="col-sm-3">
                                        <input id="gh-admin-displayname" type="text" placeholder="Administrator name" value="<%- admin.displayName %>"/>
                                    </div>
                                    <div class="col-sm-2">
                                        <input id="gh-admin-username" type="text" placeholder="Administrator username" value="<%- admin.username %>" disabled/>
                                    </div>
                                    <div class="col-sm-3">
                                        <input id="gh-admin-password" type="password" placeholder="Administrator password" value="<%- admin.password %>"/>
                                    </div>
                                    <div class="col-sm-2">
                                        <button type="submit" class="btn btn-primary">Update</button>
                                    </div>
                                    <div class="col-sm-2">
                                        <button type="button" class="btn btn-danger gh-administrators-delete" data-userid="<%- admin.id %>">Delete</button>
                                    </div>
                                </form>
                            </div>
                        <% }); %>
                        <div class="gh-striped-row row">
                            <form id="gh-administrators-create-form">
                                <div class="col-sm-3">
                                    <input id="gh-admin-displayname" type="text" placeholder="New administrator name"/>
                                </div>
                                <div class="col-sm-2">
                                    <input id="gh-admin-username" type="text" placeholder="New administrator username"/>
                                </div>
                                <div class="col-sm-3">
                                    <input id="gh-admin-password" type="password" placeholder="New administrator password"/>
                                </div>
                                <div class="col-sm-4">
                                    <button type="submit" class="btn btn-success">Create administrator</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </script>

        <script id="gh-navigation-template" type="text/template">
            <ul class="nav nav-pills nav-stacked">
                <li role="presentation" <% if (currentPage === 'configuration') { %>class="active"<% } %> >
                    <a href="/configuration">Configuration</a>
                </li>
                <li role="presentation" <% if (currentPage === 'tenants') { %>class="active"<% } %> >
                    <a href="/tenants">Tenants and Apps</a>
                </li>
                <li role="presentation" <% if (currentPage === 'users') { %>class="active"<% } %> >
                    <a href="/users">Users</a>
                </li>
            </ul>
        </script>

        <script id="gh-header-template" type="text/template">
            <% if (!data.gh.data.me || data.gh.data.me.anon) { %>
                <form class="form-inline pull-right gh-signin-form" role="form"  data-toggle="validator">
                    <%= _.partial('login-form', {'data': data}) %>
                </form>
            <% } else { %>
                <form id="gh-signout-form" class="form-inline pull-right" role="form" action="/api/auth/logout" method="POST">
                    <button type="submit" class="btn btn-default gh-btn-secondary">
                        <i class="fa fa-sign-out"></i>Sign out
                    </button>
                </form>
            <% } %>
            <h1>Administration</h1>
        </script>

        <script data-main="/shared/gh/js/gh.bootstrap.js" data-loadmodule="/apps/admin/ui/js/index.js" src="/shared/vendor/js/require-jquery.js"></script>
    </body>
</html>
