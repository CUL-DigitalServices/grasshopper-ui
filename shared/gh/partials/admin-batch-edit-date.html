<% var termNames = _.pluck(data.termsInUse, 'name'); %>

<div id="gh-batch-edit-date-term-description">
    <small>Selected terms</small>
    <h2>
    <% _.each(data.termsInUse, function(term) { %>
        <%- term.label %><br/>
    <% }); %>
    </h2>
</div>
<div id="gh-batch-edit-date-picker-container" data-terms="<%- termNames.join(',') %>">
    <!-- Show the number of weeks that are selected -->
    <small><%- data.weeksInUse.length %> week<% if (data.weeksInUse.length !== 1) { %>s<% } %> in selection</small>
    <div id="gh-batch-edit-date-picker">
        <% var totalWeeks = data.numberOfWeeks %>
        <!-- Keep rendering new weeks until the amount of weeks left to render is 0 -->
        <% while (data.numberOfWeeks) { %>
            <% data.numberOfWeeks--; %>
            <% var weekNumber = totalWeeks - data.numberOfWeeks %>
            <!-- Determine if the week should be checked or not -->
            <% var weekUsed = _.indexOf(data.weeksInUse, weekNumber) !== -1 %>
            <div class="checkbox <% if (weekUsed) { %>gh-batch-edit-date-picker-selected<% } %>">
                <label>
                    <input type="checkbox" value="<%- weekNumber %>" <% if (weekUsed) { %>checked<% } %>>W<%- weekNumber %> <i class="fa fa-square-o"></i><i class="fa fa-check-square-o"></i>
                </label>
            </div>
        <% } %>
        <% var weekUsed = _.indexOf(data.weeksInUse, 0) !== -1 %>
        <div class="checkbox <% if (weekUsed) { %>gh-batch-edit-date-picker-selected<% } else { %> hide<% } %>">
            <label>
                <input type="checkbox" value="0" <% if (weekUsed) { %>checked<% } %>>OT <i class="fa fa-square-o"></i><i class="fa fa-check-square-o"></i>
            </label>
        </div>
    </div>

    <div id="gh-batch-edit-day-picker-container">
        <% _.each(data.daysInUse, function(dayInUse, index) { %>
            <div class="form-inline gh-batch-edit-time-picker">
                <select class="pull-left form-control gh-batch-edit-day-picker" data-prev="<%- index %>">
                    <option value="4" <% if (parseInt(index, 10) === 4) { %> selected="true" <% } %>>Thursdays</option>
                    <option value="5" <% if (parseInt(index, 10) === 5) { %> selected="true" <% } %>>Fridays</option>
                    <option value="6" <% if (parseInt(index, 10) === 6) { %> selected="true" <% } %>>Saturdays</option>
                    <option value="0" <% if (parseInt(index, 10) === 0) { %> selected="true" <% } %>>Sundays</option>
                    <option value="1" <% if (parseInt(index, 10) === 1) { %> selected="true" <% } %>>Mondays</option>
                    <option value="2" <% if (parseInt(index, 10) === 2) { %> selected="true" <% } %>>Tuesdays</option>
                    <option value="3" <% if (parseInt(index, 10) === 3) { %> selected="true" <% } %>>Wednesdays</option>
                </select>
                <div class="pull-left gh-batch-edit-date-start">
                    <select class="form-control gh-batch-edit-hours-picker gh-batch-edit-hours-start">
                        <% for (var i = 7; i < 20; i += 1) { %>
                            <option value="<%= i %>" <% if (parseInt(dayInUse.startHour, 10) === i ) { %> selected="true" <% } %>><%- data.gh.utils.addLeadingZero(i) %></option>
                        <% } %>
                    </select>
                    <select class="form-control gh-batch-edit-minutes-picker gh-batch-edit-minutes-start">
                        <% for (var i = 0; i < 60; i += 15) { %>
                            <option value="<%= i %>" <% if (parseInt(dayInUse.startMinute, 10) === i ) { %> selected="true" <% } %>><%- data.gh.utils.addLeadingZero(i) %></option>
                        <% } %>
                    </select>
                </div>
                <p class="pull-left gh-batch-edit-date-to">to</p>
                <div class="pull-left gh-batch-edit-date-end">
                    <select class="form-control gh-batch-edit-hours-picker gh-batch-edit-hours-end">
                        <% for (var i = 7; i < 20; i += 1) { %>
                            <option value="<%= i %>" <% if (parseInt(dayInUse.endHour, 10) === i ) { %> selected="true" <% } %>><%- data.gh.utils.addLeadingZero(i) %></option>
                        <% } %>
                    </select>
                    <select class="form-control gh-batch-edit-minutes-picker gh-batch-edit-minutes-end">
                        <% for (var i = 0; i < 60; i += 15) { %>
                            <option value="<%= i %>" <% if (parseInt(dayInUse.endMinute, 10) === i ) { %> selected="true" <% } %>><%- data.gh.utils.addLeadingZero(i) %></option>
                        <% } %>
                    </select>
                </div>

                <!-- Only show the delete button if more than one days are in use -->
                <% if (_.keys(data.daysInUse).length > 1) { %>
                    <button class="btn btn-link gh-batch-edit-date-delete" title="Delete day from selection"><i class="fa fa-times"></i></button>
                <% } %>
            </div>
        <% }); %>
        <button type="button" class="btn btn-default gh-btn-secondary gh-batch-edit-date-add-day"><i class="fa fa-plus-square"></i> Add another day</button>
    </div>
</div>
